<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Update microdata in the P drive | PovcalNet Internal Guidelines and Protocols</title>
<meta name="author" content="PovcalNet team">
<meta name="author" content="Development Data Group">
<meta name="author" content="World Bank Group">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="https://unpkg.com/tachyons@4/css/tachyons.min.css">
<link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">PovcalNet Internal Guidelines and Protocols</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="folder-structures.html"><span class="header-section-number">2</span> Folder Structures</a></li>
<li><a class="" href="collaboration-in-git.html"><span class="header-section-number">3</span> Collaboration in Git</a></li>
<li><a class="" href="stata-github.html"><span class="header-section-number">4</span> Stata and Github</a></li>
<li class="book-part">PovcalNet Update</li>
<li><a class="" href="intro-povcal.html"><span class="header-section-number">5</span> Introduction to PovcalNet Update</a></li>
<li><a class="" href="prepare.html"><span class="header-section-number">6</span> Prepare data for PovcalNet update</a></li>
<li><a class="" href="lis-data.html"><span class="header-section-number">7</span> LIS Data</a></li>
<li><a class="" href="primus.html"><span class="header-section-number">8</span> PRIMUS</a></li>
<li><a class="active" href="update-microdata.html"><span class="header-section-number">9</span> Update microdata in the P drive</a></li>
<li><a class="" href="group-data.html"><span class="header-section-number">10</span> Group Data</a></li>
<li><a class="" href="create-pcb-files.html"><span class="header-section-number">11</span> Create .PCB files</a></li>
<li><a class="" href="DMSystem.html"><span class="header-section-number">12</span> The Data Management System</a></li>
<li><a class="" href="master-file.html"><span class="header-section-number">13</span> Update the Master file</a></li>
<li class="book-part">Miscellaneous</li>
<li><a class="" href="referencing-software-zotero.html"><span class="header-section-number">14</span> Referencing software: Zotero</a></li>
<li><a class="" href="data-visualization-flourish-studio.html"><span class="header-section-number">15</span> Data visualization: Flourish studio</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="work-expectations.html"><span class="header-section-number">A</span> Quality of work expectations</a></li>
<li><a class="" href="kihoons-handover.html"><span class="header-section-number">B</span> Kihoon’s Handover</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="update-microdata" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Update microdata in the P drive<a class="anchor" aria-label="anchor" href="#update-microdata"><i class="fas fa-link"></i></a>
</h1>
<p>Before explaining how to update our P drive, you need to make sure you
understand what the P drive is as it is explained in section
<a href="folder-structures.html#network-drive">2.1</a>.</p>
<p>The welfare data, most of it microdata but also bin and group data, reside in
the folder <code>P:/01.PovcalNet/01.Vintage_control</code>. Inside, there are two kinds of
folders, [1] country folders and [2] auxiliary folder. The former are identified
by the tree-letter ISO3 code of each country, whereas the latter start with
underscore “<em>".</em> You must be careful of never creating a folder inside”01.vintage_control" unless it starts with an underscore. Otherwise, you might
be breaking the functionality of many scripts that relies in this structure.</p>
<p>The internal structure of the country folders is the same and it follows the
<a href="%5Bhttp://ihsn.org/">International Household Survey
Network</a>](<a href="http://ihsn.org/" class="uri">http://ihsn.org/</a>)) standards. It looks
something like this,</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="http://fs.r-lib.org/reference/dir_tree.html">dir_tree</a></span><span class="op">(</span><span class="st">"p:/01.PovcalNet/01.Vintage_control/COL/"</span>, 
             regexp <span class="op">=</span> <span class="st">"COL/COL_2015_GEIH"</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; p:/01.PovcalNet/01.Vintage_control/COL/
#&gt; \-- COL_2015_GEIH
#&gt;     +-- COL_2015_GEIH_V01_M_V02_A_GMD
#&gt;     |   \-- Data
#&gt;     |       +-- COL_2015_GEIH_V01_M_V02_A_GMD_GPWG.dta
#&gt;     |       +-- COL_2015_GEIH_V01_M_V02_A_GMD_GPWG.dtasig
#&gt;     |       +-- COL_2015_GEIH_v01_M_v02_A_GMD_PCN.dta
#&gt;     |       +-- COL_2015_GEIH_v01_M_v02_A_GMD_PCN.dtasig
#&gt;     |       \-- COL_2015_GEIH_v01_M_v02_A_GMD_PCN.txt
#&gt;     \-- COL_2015_GEIH_V01_M_V03_A_GMD
#&gt;         \-- Data
#&gt;             +-- COL_2015_GEIH_V01_M_V03_A_GMD_GPWG.dta
#&gt;             +-- COL_2015_GEIH_V01_M_V03_A_GMD_GPWG.dtasig
#&gt;             +-- COL_2015_GEIH_v01_M_v03_A_GMD_PCN.dta
#&gt;             +-- COL_2015_GEIH_v01_M_v03_A_GMD_PCN.dtasig
#&gt;             \-- COL_2015_GEIH_v01_M_v03_A_GMD_PCN.txt</code></pre>
<p>Within the Colombian surveys (COL), there are as many folders as surveys
available in this country. Each folder has three components, <code>CCC_YYYY_SSSS</code>,
where <code>CCC</code> stands for the country code, <code>yyyy</code> for the year, and <code>SSSS</code> for the
survey acronym. In this case, it is <code>COL_2015_GEIH</code>. Inside this folder we have
the different version available. This is represented by the convention
<code>CCC_YYYY_SSSS_Vmm_M_Vaa_A_TTT</code>, where <code>mm</code> stands for the version of the master
data (i.e., the one released by the Government of the country), and <code>aa</code> stands
for the version of the adaptation of the survey. Finally, <code>TTT</code> refers to the
collection of the adaptation. In PovcalNet we only have the <code>GMD</code> collection.
Finally, inside each of the vintage control folder, you will find the <code>data</code>
folder and within you will find the different modules of the survey. This module
is represented by the last acronym of the name of the file, say <code>GPWG</code> or <code>PCN</code>.
This two modules are explained further below.</p>
<div id="get-povcalnet-inventory-up-to-date" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Get PovcalNet inventory up to date<a class="anchor" aria-label="anchor" href="#get-povcalnet-inventory-up-to-date"><i class="fas fa-link"></i></a>
</h2>
<p>Once everything has been approved in PRIMUS (see section <a href="primus.html#approve-primus">8.4</a>),
we can download the most recent data into our system using the directive
<code>pcn download gpwg</code>. The process of downloading the data can be done in several
ways, but we suggest two.</p>
<div id="update-all-the-years-of-selected-countries" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Update all the years of selected countries<a class="anchor" aria-label="anchor" href="#update-all-the-years-of-selected-countries"><i class="fas fa-link"></i></a>
</h3>
<p>This method is easy but highly inefficient because it could be the case that
only one year of a particular country was updated or added, but the code below
will check if all the years of that country have changed as well. You may think
that it does not make sense to download the data in this way, and you might be
right. However, downloading only the data that you need is not as
straightforward as you may think, and thus the code is a little more complex
than usual. We recommend this inefficient way because it is easy to implement,
and <code>pcn</code> is smart enough to verify whether or not the microdata has changed in
a particular year, so in case it has not changed, <code>pcn</code> won’t update the
microdata file in the P drive. It is just slow because it needs to load the
microdata from <code>datalibweb</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb27-1"><a href="update-microdata.html#cb27-1"></a>primus <span class="kw">query</span>, overallstatus(approved)</span>
<span id="cb27-2"><a href="update-microdata.html#cb27-2"></a></span>
<span id="cb27-3"><a href="update-microdata.html#cb27-3"></a><span class="kw">local</span> filtdate <span class="st">"2020-04-01"</span>   <span class="co">// change this date YYYY-MM-DD</span></span>
<span id="cb27-4"><a href="update-microdata.html#cb27-4"></a><span class="kw">keep</span> <span class="kw">if</span>  date_modified &gt;= clock(<span class="st">"`filtdate'"</span>, <span class="st">"YMD"</span>)</span>
<span id="cb27-5"><a href="update-microdata.html#cb27-5"></a><span class="kw">levelsof</span> country, <span class="kw">local</span>(countries) <span class="kw">clean</span>  <span class="co">// code of countries that changed</span></span>
<span id="cb27-6"><a href="update-microdata.html#cb27-6"></a></span>
<span id="cb27-7"><a href="update-microdata.html#cb27-7"></a>pcn download gpwg, countr(<span class="ot">`countries'</span>) </span></code></pre></div>
<p>The code above is simple. First, you query all the approved transactions in
PRIMUS using the <code>primus</code> command and keep only those transactions that were
created after the date in the local <code>filtdate</code>. Then, save in the local
<code>countries</code> the code of the countries that changed and parse it into the <code>pcn</code>
call. From there, <code>pcn</code> will take care of the update and will provide you with a
file summarizing what data was updated, added, skipped, or failed.</p>
</div>
<div id="update-file-by-file" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Update file by file<a class="anchor" aria-label="anchor" href="#update-file-by-file"><i class="fas fa-link"></i></a>
</h3>
<p>The code below may seem complex, but it is actually very simple. The MATA
function only reads the observation <code>i</code> in the <code>while</code> loop of the
already-filtered data obtained with <code>primus query</code>. You can see that it is very
similar to the code above but the main difference is that it goes file by file
instead of checking all the files of one country.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb28-1"><a href="update-microdata.html#cb28-1"></a><span class="co">//========================================================</span></span>
<span id="cb28-2"><a href="update-microdata.html#cb28-2"></a><span class="co">// Mata function</span></span>
<span id="cb28-3"><a href="update-microdata.html#cb28-3"></a><span class="co">//========================================================</span></span>
<span id="cb28-4"><a href="update-microdata.html#cb28-4"></a>cap <span class="kw">mata</span>: <span class="kw">mata</span> <span class="kw">drop</span> get_ind()</span>
<span id="cb28-5"><a href="update-microdata.html#cb28-5"></a><span class="kw">mata</span>:</span>
<span id="cb28-6"><a href="update-microdata.html#cb28-6"></a>    <span class="kw">void</span> get_ind(<span class="fu">string</span> <span class="fu">matrix</span> R) {</span>
<span id="cb28-7"><a href="update-microdata.html#cb28-7"></a>        i = strtoreal(st_local(<span class="st">"i"</span>))</span>
<span id="cb28-8"><a href="update-microdata.html#cb28-8"></a>        vars = tokens(st_local(<span class="st">"varlist"</span>))</span>
<span id="cb28-9"><a href="update-microdata.html#cb28-9"></a>        <span class="kw">for</span> (j =1; j&lt;=<span class="bn">cols</span>(vars); j++) {</span>
<span id="cb28-10"><a href="update-microdata.html#cb28-10"></a>            st_local(vars[j], R[i,j] )</span>
<span id="cb28-11"><a href="update-microdata.html#cb28-11"></a>        }</span>
<span id="cb28-12"><a href="update-microdata.html#cb28-12"></a>    } <span class="co">// end of IDs variables</span></span>
<span id="cb28-13"><a href="update-microdata.html#cb28-13"></a>    </span>
<span id="cb28-14"><a href="update-microdata.html#cb28-14"></a><span class="kw">end</span></span>
<span id="cb28-15"><a href="update-microdata.html#cb28-15"></a></span>
<span id="cb28-16"><a href="update-microdata.html#cb28-16"></a><span class="co">//========================================================</span></span>
<span id="cb28-17"><a href="update-microdata.html#cb28-17"></a><span class="co">// PRIMUS query</span></span>
<span id="cb28-18"><a href="update-microdata.html#cb28-18"></a><span class="co">//========================================================</span></span>
<span id="cb28-19"><a href="update-microdata.html#cb28-19"></a></span>
<span id="cb28-20"><a href="update-microdata.html#cb28-20"></a>primus <span class="kw">query</span>, overallstatus(approved)</span>
<span id="cb28-21"><a href="update-microdata.html#cb28-21"></a></span>
<span id="cb28-22"><a href="update-microdata.html#cb28-22"></a><span class="kw">local</span> filtdate <span class="st">"2020-04-01"</span>   <span class="co">// change this date</span></span>
<span id="cb28-23"><a href="update-microdata.html#cb28-23"></a><span class="kw">keep</span> <span class="kw">if</span>  date_modified &gt;= clock(<span class="st">"`filtdate'"</span>, <span class="st">"YMD"</span>)</span>
<span id="cb28-24"><a href="update-microdata.html#cb28-24"></a><span class="kw">levelsof</span> country, <span class="kw">local</span>(countries) <span class="kw">clean</span>  <span class="co">// code of countries that changed</span></span>
<span id="cb28-25"><a href="update-microdata.html#cb28-25"></a><span class="kw">tostring</span> <span class="dt">_all</span>, <span class="kw">replace</span></span>
<span id="cb28-26"><a href="update-microdata.html#cb28-26"></a></span>
<span id="cb28-27"><a href="update-microdata.html#cb28-27"></a><span class="kw">local</span> <span class="kw">varlist</span> = <span class="st">"country year"</span></span>
<span id="cb28-28"><a href="update-microdata.html#cb28-28"></a><span class="kw">mata</span>: R = st_sdata(.,tokens(st_local(<span class="st">"varlist"</span>)))</span>
<span id="cb28-29"><a href="update-microdata.html#cb28-29"></a><span class="kw">local</span> n = _N</span>
<span id="cb28-30"><a href="update-microdata.html#cb28-30"></a></span>
<span id="cb28-31"><a href="update-microdata.html#cb28-31"></a><span class="co">//========================================================</span></span>
<span id="cb28-32"><a href="update-microdata.html#cb28-32"></a><span class="co">// Loop over surveys</span></span>
<span id="cb28-33"><a href="update-microdata.html#cb28-33"></a><span class="co">//========================================================</span></span>
<span id="cb28-34"><a href="update-microdata.html#cb28-34"></a></span>
<span id="cb28-35"><a href="update-microdata.html#cb28-35"></a><span class="kw">local</span> i = 0</span>
<span id="cb28-36"><a href="update-microdata.html#cb28-36"></a><span class="kw">while</span> (<span class="ot">`i'</span> &lt; <span class="ot">`n'</span>) {</span>
<span id="cb28-37"><a href="update-microdata.html#cb28-37"></a>    <span class="kw">local</span> ++i</span>
<span id="cb28-38"><a href="update-microdata.html#cb28-38"></a>    </span>
<span id="cb28-39"><a href="update-microdata.html#cb28-39"></a>    <span class="kw">mata</span>: get_ind(R)</span>
<span id="cb28-40"><a href="update-microdata.html#cb28-40"></a>    disp <span class="st">"`country' - `year'"</span></span>
<span id="cb28-41"><a href="update-microdata.html#cb28-41"></a>    pcn download gpwg, countr(<span class="ot">`country'</span>)  <span class="fu">year</span>(<span class="ot">`year'</span>)</span>
<span id="cb28-42"><a href="update-microdata.html#cb28-42"></a>    </span>
<span id="cb28-43"><a href="update-microdata.html#cb28-43"></a>}</span></code></pre></div>
<p>Keep in mind the following,</p>
<ol style="list-style-type: decimal">
<li>This code works fine if you copy it and paste it in your do-file editor and
then run it directly in Stata. If you save it and then execute it from a
different file using either <code>do</code> or <code>run</code> it will fail because the <code>end</code>
command at the end of the MATA code will finish the process.</li>
<li>This code could be implemented in another subcommand of <code>pcn</code> without
running into the problem above. However, we don’t have time to do this
change. The MATA function already exists in the <code>pcn</code> repository and it is
being used by other <code>pcn</code> subroutines like <code>pcn_download_gpwg</code>. If you want
to contribute to the <code>pcn</code> by adding this feature, you’re more than welcome!
😉.</li>
<li>The only problem with this approach is that you won’t get at the end of the
process a nice file summarizing what happened with each file. This could
also be fixed if this routine is included as part of <code>pcn</code>.</li>
</ol>
</div>
</div>
<div id="create-the-_pcn-files" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Create the _PCN files<a class="anchor" aria-label="anchor" href="#create-the-_pcn-files"><i class="fas fa-link"></i></a>
</h2>
<p>The final step before having the microdata ready to be converted to .pcb files
and ingested by the PovcalNet system is to create the “PCN” files. These files
are just an adaptation of the GPWG microdata in the P drive. They are called
“PCN” because that is their suffix in the naming convention. For instance, the
“_PCN” file of <em>COL_2017_GEIH_V01_M_V01_A_GMD<strong>_GPWG</strong>.dta</em> is
<em>COL_2017_GEIH_v01_M_v01_A_GMD<span class="red">_PCN</span>.dta.</em> This conversion is done
through the <code>pcn create</code> directive. In the case above, for instance, you only
need to execute the directive,</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb29-1"><a href="update-microdata.html#cb29-1"></a>pcn create, countries(COL) <span class="fu">year</span>(2017) <span class="kw">clear</span></span></code></pre></div>
<p>Also, you can create the “PCN” files of all surveys, by just typing,</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb30-1"><a href="update-microdata.html#cb30-1"></a>pcn create, countries(ALL)</span></code></pre></div>
<p>You may need to use the option <code>replace</code> in the directive above, in case you
want to replace an existing “PCN” file. In similar fashion as
<code>pcn download gpwg</code>, <code>pcn create</code> compares current data in the P drive and does
not replace anything unless you make this option explicit.</p>
<p>Also, if you want to understand what the <code>pcn create</code> directive does, you can
look at the file <code>pcn_create.ado</code>, but it general it makes sure to load the data
in the P drive and standardize the output to make it ready for PovcalNet. For
instance, it replace zeros and missing values of the welfare and weight
variables like this,</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb31-1"><a href="update-microdata.html#cb31-1"></a>* <span class="kw">drop</span> <span class="fu">missing</span> <span class="kw">values</span></span>
<span id="cb31-2"><a href="update-microdata.html#cb31-2"></a><span class="kw">drop</span> <span class="kw">if</span> welfare &lt; 0 | welfare == .</span>
<span id="cb31-3"><a href="update-microdata.html#cb31-3"></a><span class="kw">drop</span> <span class="kw">if</span> <span class="kw">weight</span> &lt;= 0 | <span class="kw">weight</span> == .</span></code></pre></div>
<p>Or make sure the <code>weight</code> variable is exactly the same for all the files,</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb32-1"><a href="update-microdata.html#cb32-1"></a>cap <span class="kw">confirm</span> <span class="kw">var</span> <span class="kw">weight</span>, exact</span>
<span id="cb32-2"><a href="update-microdata.html#cb32-2"></a><span class="kw">if</span> (<span class="dt">_rc</span>) {</span>
<span id="cb32-3"><a href="update-microdata.html#cb32-3"></a>    cap <span class="kw">confirm</span> <span class="kw">var</span> weight_p, exact</span>
<span id="cb32-4"><a href="update-microdata.html#cb32-4"></a>    <span class="kw">if</span> (<span class="dt">_rc</span> == 0) <span class="kw">rename</span> weight_p <span class="kw">weight</span></span>
<span id="cb32-5"><a href="update-microdata.html#cb32-5"></a>    <span class="kw">else</span> {</span>
<span id="cb32-6"><a href="update-microdata.html#cb32-6"></a>        cap <span class="kw">confirm</span> <span class="kw">var</span> weight_h, exact</span>
<span id="cb32-7"><a href="update-microdata.html#cb32-7"></a>        <span class="kw">if</span> (<span class="dt">_rc</span> == 0) <span class="kw">rename</span> weight_h <span class="kw">weight</span></span>
<span id="cb32-8"><a href="update-microdata.html#cb32-8"></a>        <span class="kw">else</span> {</span>
<span id="cb32-9"><a href="update-microdata.html#cb32-9"></a>            <span class="kw">noi</span> disp <span class="kw">in</span> <span class="kw">red</span> <span class="st">"no weight variable found for country(`country') year(`year') veralt(`veralt') "</span></span>
<span id="cb32-10"><a href="update-microdata.html#cb32-10"></a>            <span class="kw">local</span> status <span class="st">"error. cleaning"</span></span>
<span id="cb32-11"><a href="update-microdata.html#cb32-11"></a>            <span class="kw">local</span> dlwnote <span class="st">"no weight variable found for country(`country') year(`year') "</span></span>
<span id="cb32-12"><a href="update-microdata.html#cb32-12"></a>            <span class="kw">mata</span>: P = pcn_info(P)</span>
<span id="cb32-13"><a href="update-microdata.html#cb32-13"></a>            <span class="kw">noi</span> <span class="kw">_dots</span> <span class="ot">`i'</span> 1</span>
<span id="cb32-14"><a href="update-microdata.html#cb32-14"></a>            <span class="kw">continue</span></span>
<span id="cb32-15"><a href="update-microdata.html#cb32-15"></a>        }</span>
<span id="cb32-16"><a href="update-microdata.html#cb32-16"></a>    }</span>
<span id="cb32-17"><a href="update-microdata.html#cb32-17"></a>}</span></code></pre></div>
<p>This command also makes sure to do the proper adjustments to the India and
Indonesia datasets.</p>
<p><span class="red bg-light-blue">Daniel, could you please provide a short explanation of the IND and IDN
adjustment?</span></p>
<div class="rmdbox rmdcaution">
<p>Make sure that for all the new GPWG that you download from <code>datalibweb</code> based on
the PRIMUS catalog, you create all the corresponding PCN files.</p>
</div>
</div>
<div id="china-synthetic-files" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> China synthetic files<a class="anchor" aria-label="anchor" href="#china-synthetic-files"><i class="fas fa-link"></i></a>
</h2>
<p><span style=".red .bg-light-blue">To be updated by David.</span></p>
<p>blah blah</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="primus.html"><span class="header-section-number">8</span> PRIMUS</a></div>
<div class="next"><a href="group-data.html"><span class="header-section-number">10</span> Group Data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#update-microdata"><span class="header-section-number">9</span> Update microdata in the P drive</a></li>
<li>
<a class="nav-link" href="#get-povcalnet-inventory-up-to-date"><span class="header-section-number">9.1</span> Get PovcalNet inventory up to date</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#update-all-the-years-of-selected-countries"><span class="header-section-number">9.1.1</span> Update all the years of selected countries</a></li>
<li><a class="nav-link" href="#update-file-by-file"><span class="header-section-number">9.1.2</span> Update file by file</a></li>
</ul>
</li>
<li><a class="nav-link" href="#create-the-_pcn-files"><span class="header-section-number">9.2</span> Create the _PCN files</a></li>
<li><a class="nav-link" href="#china-synthetic-files"><span class="header-section-number">9.3</span> China synthetic files</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines//blob/master/update_microdata.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines//edit/master/update_microdata.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>PovcalNet Internal Guidelines and Protocols</strong>" was written by PovcalNet team, Development Data Group, World Bank Group. It was last built on 2020-12-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
