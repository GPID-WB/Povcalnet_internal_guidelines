<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 LIS Data | PovcalNet Internal Guidelines and Protocols</title>
<meta name="author" content="PovcalNet team">
<meta name="author" content="Development economics">
<meta name="author" content="World Bank Group">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="https://unpkg.com/tachyons@4/css/tachyons.min.css">
<link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">PovcalNet Internal Guidelines and Protocols</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="folder-structures.html"><span class="header-section-number">2</span> Folder Structures</a></li>
<li><a class="" href="collaboration-in-git.html"><span class="header-section-number">3</span> Collaboration in Git</a></li>
<li><a class="" href="stata-github.html"><span class="header-section-number">4</span> Stata and Github</a></li>
<li class="book-part">PovcalNet Update</li>
<li><a class="" href="intro-povcal.html"><span class="header-section-number">5</span> Introduction to PovcalNet Update</a></li>
<li><a class="" href="prepare.html"><span class="header-section-number">6</span> Prepare data for PovcalNet update</a></li>
<li><a class="active" href="lis-data.html"><span class="header-section-number">7</span> LIS Data</a></li>
<li><a class="" href="primus.html"><span class="header-section-number">8</span> PRIMUS</a></li>
<li><a class="" href="update-microdata.html"><span class="header-section-number">9</span> Update microdata in the P drive</a></li>
<li><a class="" href="group-data.html"><span class="header-section-number">10</span> Group Data</a></li>
<li><a class="" href="create-pcb-files.html"><span class="header-section-number">11</span> Create .PCB files</a></li>
<li><a class="" href="DMSystem.html"><span class="header-section-number">12</span> The Data Management System</a></li>
<li><a class="" href="master-file.html"><span class="header-section-number">13</span> Update the Master file</a></li>
<li class="book-part">Miscellaneous</li>
<li><a class="" href="referencing-software-zotero.html"><span class="header-section-number">14</span> Referencing software: Zotero</a></li>
<li><a class="" href="data-visualization-flourish-studio.html"><span class="header-section-number">15</span> Data visualization: Flourish studio</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="work-expectations.html"><span class="header-section-number">A</span> Quality of work expectations</a></li>
<li><a class="" href="kihoons-handover.html"><span class="header-section-number">B</span> Kihoonâ€™s Handover</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lis-data" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> LIS Data<a class="anchor" aria-label="anchor" href="#lis-data"><i class="fas fa-link"></i></a>
</h1>
<p>Some of the countries that are not available in DataLibWeb (or additional years for countries that are included in DLW) can be found in the
repository of the <a href="https://www.lisdatacenter.org/">LIS Cross-National Data
Center</a> (hereafter, LIS). LIS provides a
remote-execution system,
<a href="http://www.lisdatacenter.org/data-access/lissy/">LISSY,</a> that allows us
interact with their micrdata without having access to the individual records. We
have developed a set of Stata do-files to interact with the LIS system and
aggregate the welfare distribution of countries of interest to 400 bins. Then,
these data is organized locally and shared with the Poverty GP to be included in
DataLibWeb as a collection independent from GPWG.</p>
<div id="the-lis_data-repository" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> The LIS_data repository<a class="anchor" aria-label="anchor" href="#the-lis_data-repository"><i class="fas fa-link"></i></a>
</h2>
<p>In order to work with the LIS data you need to clone the repository
<a href="https://github.com/PovcalNet-Team/LIS_data">PovcalNet-Team/LIS/_data.</a> You
will find in there three folders, <em>00.LIS_output</em>, <em>01.programs</em>, and
<em>02.data</em>.</p>
</div>
<div id="interacting-with-lissy" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Interacting with LISSY<a class="anchor" aria-label="anchor" href="#interacting-with-lissy"><i class="fas fa-link"></i></a>
</h2>
<div class="bg-light-green">
<div class="tl">
<p><strong>Marthis:</strong></p>
</div>
<div class="dark-blue">
<ul>
<li>How to open an account in LISSY</li>
<li>How to log in and work inside LISSY</li>
</ul>
</div>
</div>
</div>
<div id="getting-the-400-bins-from-lissy" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Getting the 400 bins from LISSY<a class="anchor" aria-label="anchor" href="#getting-the-400-bins-from-lissy"><i class="fas fa-link"></i></a>
</h2>
<div class="bg-light-green">
<div class="tl">
<p><strong>Marthis:</strong></p>
</div>
<div class="dark-blue">
<ul>
<li>What parts of the do-file we should modify</li>
<li>How and where to save the results (Exaplain the naming so it could be used
in the <code>02.LIS_organize_output.do</code> file)</li>
</ul>
</div>
</div>
</div>
<div id="from-text-file-to-datalibweb-structure" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> From Text file to datalibweb structure<a class="anchor" aria-label="anchor" href="#from-text-file-to-datalibweb-structure"><i class="fas fa-link"></i></a>
</h2>
<p>We now need to convert the text files generated by the LISSY system to
data files suitable for datalibweb. This structure is suggested by the
<a href="https://ihsn.org/">International Household Survey Network</a> (IHSN). Once the
data is saved in folder <code>00.LIS_output</code> you need to execute the file
<strong><code>02.LIS_organize_output.do</code></strong>. This file is designed to be executed in just one
go. However, it can be run in sections taking advantage of the different
<a href="https://www.stata.com/new-in-stata/multiple-datasets-in-memory/">frames</a> along
the code.</p>
<p>Before you execute this code, you need to ensure a few things,</p>
<div id="get-rcall-working-in-your-computer" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> 1. Get <code>rcall</code> working in your computer<a class="anchor" aria-label="anchor" href="#get-rcall-working-in-your-computer"><i class="fas fa-link"></i></a>
</h3>
<p>The text files are no longer processed in Stata but in R. To avoid
changing systems, we need to execute R code directly from Stata. In order to do
this, you need to install R in your computer and also the
Stata command <code>rcall</code>. The do-file <code>02.LIS_organize_output.do</code> will check if you
have it installed and will install it for you in case it is not. However, you
can run the lines below to make sure everything is working fine. Also, you can
take a look at the help file of <code>rcall</code> to get familiar with it.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb15-1"><a href="lis-data.html#cb15-1"></a>cap which rcall</span>
<span id="cb15-2"><a href="lis-data.html#cb15-2"></a><span class="kw">if</span> (<span class="dt">_rc</span>) {</span>
<span id="cb15-3"><a href="lis-data.html#cb15-3"></a>    cap which github</span>
<span id="cb15-4"><a href="lis-data.html#cb15-4"></a>    <span class="kw">if</span> (<span class="dt">_rc</span>) {</span>
<span id="cb15-5"><a href="lis-data.html#cb15-5"></a>        net install github, from(<span class="st">"https://haghish.github.io/github/"</span>)</span>
<span id="cb15-6"><a href="lis-data.html#cb15-6"></a>    }</span>
<span id="cb15-7"><a href="lis-data.html#cb15-7"></a>    github install haghish/rcall, stable</span>
<span id="cb15-8"><a href="lis-data.html#cb15-8"></a>}</span></code></pre></div>
</div>
<div id="personal-drive" class="section level3 unnumbered" number="">
<h3>2. Personal Drive<a class="anchor" aria-label="anchor" href="#personal-drive"><i class="fas fa-link"></i></a>
</h3>
<p>Make sure to add your UPI to the appropriate sections by typing
<code>disp lower("`c(username)'")</code> , following the example below,</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb16-1"><a href="lis-data.html#cb16-1"></a><span class="kw">if</span> (<span class="fu">lower</span>(<span class="st">"`c(username)'"</span>) == <span class="st">"wbxxxxx"</span>) {</span>
<span id="cb16-2"><a href="lis-data.html#cb16-2"></a>    <span class="kw">local</span> <span class="ot">dir</span> <span class="st">"c:/Users/wbxxxxx/OneDrive - WBG/WorldBank/DECDG/PovcalNet Team/LIS_data"</span></span>
<span id="cb16-3"><a href="lis-data.html#cb16-3"></a>}</span></code></pre></div>
</div>
<div id="directives-of-the-code" class="section level3 unnumbered" number="">
<h3>3. Directives of the code<a class="anchor" aria-label="anchor" href="#directives-of-the-code"><i class="fas fa-link"></i></a>
</h3>
<p>This do-file works like an ado-file in the sense that the output depends on the
value of some local macros,</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb17-1"><a href="lis-data.html#cb17-1"></a><span class="kw">global</span> update_surveynames = 1 <span class="co">// 1 to update survey names.</span></span>
<span id="cb17-2"><a href="lis-data.html#cb17-2"></a><span class="kw">global</span> <span class="kw">replace</span>            = 0 <span class="co">// 1 to replace data in memory even if it has not changed</span></span>
<span id="cb17-3"><a href="lis-data.html#cb17-3"></a><span class="kw">global</span> p_drive_output_dir = 0 <span class="co">// 1 to use default Vintage_control folder</span></span></code></pre></div>
<p>If local <code>update_surveynames</code> is set to 1, the code will load the sheet
<code>LIS_survname</code> from the file <code>02.data/_aux/LIS datasets.xlsx</code> and updated
the file <code>02.data/_aux/LIS_survname.dta</code>. If <code>replace</code> is set to 1, the code
will replace any output with the same name. Otherwise, it will create a new
vintage version <em>if the two files are different</em>. If they are not different, the
code will do nothing. local <code>p_drive_output_dir</code> is deprecated, so you must
leave it as <strong>0</strong>.</p>
</div>
<div id="pattern-of-the-text-files" class="section level3 unnumbered" number="">
<h3>4. Pattern of the text files<a class="anchor" aria-label="anchor" href="#pattern-of-the-text-files"><i class="fas fa-link"></i></a>
</h3>
<p>When the text files with the information from LIS are stored in <code>00.LIS_output</code>,
they should be stored in a systematic way so that they could be loaded and
processed at the same time. This can be done by specifying in a matching regular
expression in local <code>pattern</code>. For instance, all the files downloaded in
December, 2020 could by loaded and processed using the directive,
<code>local pattern = "LISSY_Dec2020.*txt"</code>.</p>
</div>
<div id="output" class="section level3 unnumbered" number="">
<h3>5. Output<a class="anchor" aria-label="anchor" href="#output"><i class="fas fa-link"></i></a>
</h3>
<p>When the do-file is concluded, it saves the file <code>02.data/create_dta_status.dta</code>
with the status of all the surveys processed.</p>
</div>
</div>
<div id="compare-new-lis-data-to-datalibweb-inventory" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Compare new LIS data to Datalibweb inventory<a class="anchor" aria-label="anchor" href="#compare-new-lis-data-to-datalibweb-inventory"><i class="fas fa-link"></i></a>
</h2>
<p>To identify what data is new and what data has changed with respect to the one
available in datalibweb, you need to execute do-file <code>03.LIS_compare_dlw.do</code>.
Again, this do-file is intended to be executed in one run, but you can do it in
parts taking advantage of the different frames. At the end of the execution, the
file <code>02.data/comparison_results.dta</code> is created. This file contains three
important variables <code>wf</code>, <code>wt</code>, and <code>gn</code>, which correspond to the ratio of
welfare means, weight means, and Gini coefficient between the data in datalibweb
and the data in the folder, <code>p:/01.PovcalNet/03.QA/06.LIS/03.Vintage_control</code>.</p>
<p>You should only send to the Poverty GP those surveys for which at least one of
these three variables is different from 1.</p>
</div>
<div id="the-excel-file-lis-datasets.xlsx" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> The Excel file <code>LIS datasets.xlsx</code><a class="anchor" aria-label="anchor" href="#the-excel-file-lis-datasets.xlsx"><i class="fas fa-link"></i></a>
</h2>
<div class="bg-light-green">
<div class="dark-red">
<p>Marthis:</p>
</div>
<p>Explanation of the Excel file with the name of the surveys.</p>
</div>
</div>
<div id="prepare-data-for-the-poverty-gp" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Prepare data for the Poverty GP<a class="anchor" aria-label="anchor" href="#prepare-data-for-the-poverty-gp"><i class="fas fa-link"></i></a>
</h2>
<p>Finally, do-file <code>04.Append_new_LIS_bases.do</code> prepares the data to be shared
with the Poverty GP.</p>
<p><span class="bg-light-green dark-red">Marthis:Could please explain the whole process? Do we have additional do-files
for this part? If we do, we need to add them to the repository.</span></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="prepare.html"><span class="header-section-number">6</span> Prepare data for PovcalNet update</a></div>
<div class="next"><a href="primus.html"><span class="header-section-number">8</span> PRIMUS</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lis-data"><span class="header-section-number">7</span> LIS Data</a></li>
<li><a class="nav-link" href="#the-lis_data-repository"><span class="header-section-number">7.1</span> The LIS_data repository</a></li>
<li><a class="nav-link" href="#interacting-with-lissy"><span class="header-section-number">7.2</span> Interacting with LISSY</a></li>
<li><a class="nav-link" href="#getting-the-400-bins-from-lissy"><span class="header-section-number">7.3</span> Getting the 400 bins from LISSY</a></li>
<li>
<a class="nav-link" href="#from-text-file-to-datalibweb-structure"><span class="header-section-number">7.4</span> From Text file to datalibweb structure</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#get-rcall-working-in-your-computer"><span class="header-section-number">7.4.1</span> 1. Get rcall working in your computer</a></li>
<li><a class="nav-link" href="#personal-drive">2. Personal Drive</a></li>
<li><a class="nav-link" href="#directives-of-the-code">3. Directives of the code</a></li>
<li><a class="nav-link" href="#pattern-of-the-text-files">4. Pattern of the text files</a></li>
<li><a class="nav-link" href="#output">5. Output</a></li>
</ul>
</li>
<li><a class="nav-link" href="#compare-new-lis-data-to-datalibweb-inventory"><span class="header-section-number">7.5</span> Compare new LIS data to Datalibweb inventory</a></li>
<li><a class="nav-link" href="#the-excel-file-lis-datasets.xlsx"><span class="header-section-number">7.6</span> The Excel file LIS datasets.xlsx</a></li>
<li><a class="nav-link" href="#prepare-data-for-the-poverty-gp"><span class="header-section-number">7.7</span> Prepare data for the Poverty GP</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines//blob/master/lis_data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines//edit/master/lis_data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>PovcalNet Internal Guidelines and Protocols</strong>" was written by PovcalNet team, Development economics, World Bank Group. It was last built on 2020-12-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
