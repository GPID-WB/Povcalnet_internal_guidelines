<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Prepare data for PovcalNet update | PovcalNet Internal Guidelines and Protocols</title>
<meta name="author" content="PovcalNet team">
<meta name="author" content="Development Data Group">
<meta name="author" content="World Bank Group">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.3/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="https://unpkg.com/tachyons@4/css/tachyons.min.css">
<link rel="stylesheet" href="css/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">PovcalNet Internal Guidelines and Protocols</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="folder-structures.html"><span class="header-section-number">2</span> Folder Structures</a></li>
<li><a class="" href="collaboration-in-git.html"><span class="header-section-number">3</span> Collaboration in Git</a></li>
<li><a class="" href="stata-github.html"><span class="header-section-number">4</span> Stata and Github</a></li>
<li class="book-part">PovcalNet Update</li>
<li><a class="" href="intro-povcal.html"><span class="header-section-number">5</span> Introduction to PovcalNet Update</a></li>
<li><a class="active" href="prepare.html"><span class="header-section-number">6</span> Prepare data for PovcalNet update</a></li>
<li><a class="" href="lis-data.html"><span class="header-section-number">7</span> LIS Data</a></li>
<li><a class="" href="primus.html"><span class="header-section-number">8</span> PRIMUS</a></li>
<li><a class="" href="update-microdata.html"><span class="header-section-number">9</span> Update microdata in the P drive</a></li>
<li><a class="" href="group-data.html"><span class="header-section-number">10</span> Group Data</a></li>
<li><a class="" href="create-pcb-files.html"><span class="header-section-number">11</span> Create .PCB files</a></li>
<li><a class="" href="DMSystem.html"><span class="header-section-number">12</span> The Data Management System</a></li>
<li><a class="" href="master-file.html"><span class="header-section-number">13</span> Update the Master file</a></li>
<li class="book-part">Miscellaneous</li>
<li><a class="" href="referencing-software-zotero.html"><span class="header-section-number">14</span> Referencing software: Zotero</a></li>
<li><a class="" href="data-visualization-flourish-studio.html"><span class="header-section-number">15</span> Data visualization: Flourish studio</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="work-expectations.html"><span class="header-section-number">A</span> Quality of work expectations</a></li>
<li><a class="" href="kihoons-handover.html"><span class="header-section-number">B</span> Kihoon’s Handover</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="prepare" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Prepare data for PovcalNet update<a class="anchor" aria-label="anchor" href="#prepare"><i class="fas fa-link"></i></a>
</h1>
<p>In this chapter we briefly describe what needs to be done with each auxiliary
dataset used to update PovcalNet. Each of the next sections describes one
dataset and, in general, they are divided in <strong>Raw Data</strong> and <strong>Update Master
File</strong> subsection.</p>
<p>Most of the updating of the master file is carried by the
<code>pcn master, udpate(sheet)</code> command in Stata, where <code>sheet</code> refers to name of
the sheet in the master file. If you need to make any modification, please make
sure to create a new branch from the most recent of the master branch in the
<a href="https://github.com/PovcalNet-Team/pcn">PovcalNet-Team/pcn</a> Github repository.</p>
<div id="population" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Population<a class="anchor" aria-label="anchor" href="#population"><i class="fas fa-link"></i></a>
</h2>
<div id="raw-data" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Raw data<a class="anchor" aria-label="anchor" href="#raw-data"><i class="fas fa-link"></i></a>
</h3>
<p>Everything related population data should be placed in the folder
<code>p:/01.PovcalNet/03.QA/03.Population</code>, hereafter (<code>./</code>).</p>
<p>Population data is saved in the folder <code>./data</code>. The data may come from two
different sources, WDI or from an internal source in DECDG. Right now, the data
is built and shared by <code>Emi Suzuki &lt;esuzuki1@worldbank.org&gt;</code> in an Excel file.</p>
<p>The file shared by Emi should be placed without modification in the folder
<code>./data/original</code>. Then, the file is copied again into the folder <code>./data</code> with
the name <code>population_country_yyyy-mm-dd.xlsx</code> where <code>yyyy-mm-dd</code> refers to the
official release date of the population data. As of today,
January 06, 2021, the files available in the system are,</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="http://fs.r-lib.org/reference/dir_tree.html">dir_tree</a></span><span class="op">(</span><span class="st">"p:/01.PovcalNet/03.QA/03.Population/data"</span>, 
             recurse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; p:/01.PovcalNet/03.QA/03.Population/data
#&gt; +-- original
#&gt; +-- population_aggregate_2019-07-01.xlsx
#&gt; +-- population_country_2019-07-01.xlsx
#&gt; +-- population_country_2020-07-01.xlsx
#&gt; +-- population_country_2020-12-01.xlsx
#&gt; \-- population_missing_2020-12-01.xlsx</code></pre>
<p>The main file shared by Emi has data gaps for KWT, PSE, and SXM.
She shared another file that fills these gaps, which is saved in the above folder as <code>population_missing_2020_12_01.xlsx</code>.
It is unlikely that this file will change, given that the data gaps concern historical figures. Right now this ‘missing’ file is automatically accounted for when updating the master file (see below). In the unlikely case that these data will be updated, the code in pcn_master_update.ado needs to be updated manually to reflect the newer file.</p>
</div>
<div id="update-master-file" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> update master file<a class="anchor" aria-label="anchor" href="#update-master-file"><i class="fas fa-link"></i></a>
</h3>
<p>Once the new raw population data is in the folder <code>./data</code> it is necessary to
update the <code>population</code> sheet in the master file. This can be done by just
typing,</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb12-1"><a href="prepare.html#cb12-1"></a>pcn master, update(population)</span></code></pre></div>
<p>Finally, you can check the differences between the two versions by using the
following code,</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb13-1"><a href="prepare.html#cb13-1"></a>pcn master, <span class="kw">load</span>(Population) </span>
<span id="cb13-2"><a href="prepare.html#cb13-2"></a><span class="kw">rename</span> population pop2</span>
<span id="cb13-3"><a href="prepare.html#cb13-3"></a></span>
<span id="cb13-4"><a href="prepare.html#cb13-4"></a><span class="kw">tempfile</span> pop2</span>
<span id="cb13-5"><a href="prepare.html#cb13-5"></a><span class="kw">save</span> <span class="ot">`pop2'</span></span>
<span id="cb13-6"><a href="prepare.html#cb13-6"></a></span>
<span id="cb13-7"><a href="prepare.html#cb13-7"></a><span class="co">// 'the version to compare with must change depending on the vintage available</span></span>
<span id="cb13-8"><a href="prepare.html#cb13-8"></a>pcn master, <span class="kw">load</span>(Population) <span class="kw">version</span>(-1) </span>
<span id="cb13-9"><a href="prepare.html#cb13-9"></a><span class="kw">rename</span> population pop1</span>
<span id="cb13-10"><a href="prepare.html#cb13-10"></a><span class="kw">merge</span> 1:1 countrycode coveragetype <span class="fu">year</span> <span class="kw">using</span> <span class="ot">`pop2'</span>, <span class="kw">gen</span>(checkpop)  <span class="co">// '</span></span>
<span id="cb13-11"><a href="prepare.html#cb13-11"></a></span>
<span id="cb13-12"><a href="prepare.html#cb13-12"></a><span class="kw">tab</span> <span class="fu">year</span> <span class="kw">if</span> (checkpop == 2)</span>
<span id="cb13-13"><a href="prepare.html#cb13-13"></a><span class="kw">tab</span> countryname <span class="kw">if</span> (checkpop == 2 &amp; <span class="fu">year</span> &lt; 2019)</span>
<span id="cb13-14"><a href="prepare.html#cb13-14"></a><span class="kw">gen</span> diffpop = pop1 - pop2</span>
<span id="cb13-15"><a href="prepare.html#cb13-15"></a><span class="kw">sum</span> diffpop</span>
<span id="cb13-16"><a href="prepare.html#cb13-16"></a>br <span class="kw">if</span> <span class="fu">abs</span>(diffpop) &gt; <span class="ot">`r(mean)'</span>*2*<span class="ot">`r(sd)'</span> &amp; diffpop != .</span></code></pre></div>
<p>Keep in mind that option <code><a href="https://rdrr.io/r/base/Version.html">version(-1)</a></code> refers to one version before the current
one. If it were <code><a href="https://rdrr.io/r/base/Version.html">version(-2)</a></code>, it would be two versions before the current one.
Keep in mind that the negative integer in this function refers to the version of
the master file and not to the version of the sheet you’re loading. Currently,
there is no way to track the versions of each sheet in the Master file.</p>
</div>
</div>
<div id="gdp-and-consumption-pce" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> GDP and Consumption (PCE)<a class="anchor" aria-label="anchor" href="#gdp-and-consumption-pce"><i class="fas fa-link"></i></a>
</h2>
<p>GDP and consumption data are used to measure economic growth for the
interpolation and extrapolation calculations. PCE refers to “per capita
expenditure”, more conventionally known as household final consumption
expenditure (HFCE).</p>
<div id="raw-data-1" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Raw data<a class="anchor" aria-label="anchor" href="#raw-data-1"><i class="fas fa-link"></i></a>
</h3>
<p>The raw data of GDP and PCE data comes from WDI through the Stata command
<code>wbopendata</code>. For GDP the indicator is <code>NY.GDP.PCAP.KD</code> (GDP per
capita–constant 2010 US$) and for PCE the indicator used is
<code>NE.CON.PRVT.PC.KD</code> (Households Final Consumption Expenditure per
capita–constant 2010 US$). For some countries, however, the economic growth
data is not available in WDI, so it has to be gathered from other sources
besides WDI. You can see <a href="prepare.html#scnac">below</a> a deeper explanation and process on how
to update the auxiliary files of these <em>special cases</em>.</p>
<p><span class="red"><strong>TODO:</strong> Talk about the Maddisson data</span>.</p>
<div id="scnac" class="section level4 unnumbered" number="">
<h4>National accounts for “special cases”<a class="anchor" aria-label="anchor" href="#scnac"><i class="fas fa-link"></i></a>
</h4>
<p>The <em>Special Cases</em> can be found in the folder
<code>P:/01.PovcalNet/03.QA/04.NationalAccounts/data</code>. This folder contains all the
different versions previously used in <strong>PovcalNet</strong> with national accounts info
on special cases. Each file is called <code>NAS special_YYYY-mm-dd.xlsx</code>, where
<code>YYYY</code> refers to year, <code>mm</code>to month, and <code>dd</code>to day (identifying the vintage of
the file). When you update the information of these files make sure you,</p>
<ol style="list-style-type: decimal">
<li>open the most recent version,</li>
<li>save with the current date</li>
<li>edit it as needed</li>
</ol>
<p>In order to update the <em>special cases</em> file, do the following,</p>
<ol style="list-style-type: decimal">
<li>Get the relevant data from the latest versions of the <a href="https://www.imf.org/en/Publications/SPROLLs/world-economic-outlook-databases#sort=%40imfdate%20descending">World Economic
Outlook</a>
(WEO). The WEO series for GDP is <strong>NGDPRPC</strong>. If <strong>NGDPRPC</strong> is not
available, use the growth rate provided in <strong>NGDPRPPPPCPCH</strong> to splice on
the series. Consumption data are not available in (the public version of)
WEO.</li>
<li>Update the non-missing observations in the PCE and GDP series. <em>Make sure
there is no observation where both PCE and GDP are missing</em>. Venezuela is an
exception to this rule: In this case, we simply use the series available in
WDI, which is missing in recent years.</li>
<li>In the Excel file for the national accounts, you will find the source of
data and clues on how best to update each observation. Unless otherwise
instructed by R.Andrés Castañeda or Christoph Lakner, use the source in the
latest version of the national accounts to update the relevant observations.
IMPORTANT: You should check whether the country-year is still a special
case; e.g. the standard WDI source may have been extended to cover
additional years. Similarly, there could be new special cases (i.e. WDI
observations were available in a previous vintage, but no longer are).</li>
<li>For India, update the latest Excel file with pass-through calculations,
which can be found at <code>P:/01.PovcalNet/03.QA/04.NationalAccounts/data/_aux</code>.
Follow instructions in the Excel file and Daniel Mahler to update rural and
urban PCE.</li>
<li>Make sure you have the exact variables (countryname coverage countrycode
year GDP PCE sourceGDP sourcePCE) as in the previous Excel file for the
special cases national accounts.The variable names are case-sensitive.</li>
</ol>
</div>
<div id="description-of-series" class="section level4 unnumbered" number="">
<h4>Description of series<a class="anchor" aria-label="anchor" href="#description-of-series"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><strong><em>NE.CON.PRVT.PC.KD</em></strong>: Household final consumption expenditure per capita
(constant 2010 US$).</p></li>
<li><p><strong><em>NY.GDP.PCAP.KD</em></strong>: GDP per capita is gross domestic product divided by
midyear population. Data are in constant 2010 U.S. dollars.</p></li>
<li><p><strong><em>NGDPRPC</em></strong>: Gross domestic product per capita, constant prices. GDP is
expressed in constant national currency per person. Data are derived by
dividing constant price GDP by total population.</p></li>
<li><p><strong><em>NGDPRPPPPCPCH</em></strong>: Gross domestic product per capita, constant prices
(purchasing power parity; percent change). Data are derived by dividing
constant price purchasing-power parity (PPP) GDP by total population.</p></li>
</ul>
</div>
</div>
<div id="update-master-file-1" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> Update master file<a class="anchor" aria-label="anchor" href="#update-master-file-1"><i class="fas fa-link"></i></a>
</h3>
<p>Once the <em>special cases</em> file has been updated you must update the master file
by using the following command lines,</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb14-1"><a href="prepare.html#cb14-1"></a>pcn master, update(gdp)</span>
<span id="cb14-2"><a href="prepare.html#cb14-2"></a>pcn master, update(pce)</span></code></pre></div>
<p>The <code>pcn</code> command integrates all the WDI, Maddisson, and Special Cases files in
the correct format of the master file. You can run these lines even if only one
of the sources gets updated. If you want to understand how these two sheets get
updated, you can see the procedure in the file
<a href="https://github.com/PovcalNet-Team/pcn/blob/master/pcn_master_update.ado"><em>pcn_master_update.ado</em></a><em>.</em>
In particular, you can see <a href="https://github.com/PovcalNet-Team/pcn/blob/790a1b1fc721199dfe1cdbbc103d399174785cc9/pcn_master_update.ado#L170-L354">these
lines</a>
for GDP and <a href="https://github.com/PovcalNet-Team/pcn/blob/790a1b1fc721199dfe1cdbbc103d399174785cc9/pcn_master_update.ado#L360-L508">these
lines</a>
for PCE.</p>
</div>
</div>
<div id="cpi-and-ppp" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> CPI and PPP<a class="anchor" aria-label="anchor" href="#cpi-and-ppp"><i class="fas fa-link"></i></a>
</h2>
<p>Even though the CPI and PPP come from different sources, in the PovcalNet update
process we use the most recent version provided by <code>datalibweb</code> (DLW). DLW
provides a curated, clean, and organized file with all the CPIs and PPPs values
for all the countries and years. If you want to load the most recent version
directly from DLW, you use the following lines of code,</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb15-1"><a href="prepare.html#cb15-1"></a><span class="kw">local</span> cpipath <span class="st">"c:</span><span class="ch">\a</span><span class="st">do\personal\Datalibweb\data\GMD\SUPPORT\SUPPORT_2005_CPI"</span></span>
<span id="cb15-2"><a href="prepare.html#cb15-2"></a><span class="kw">local</span> cpidirs: <span class="ot">dir</span> <span class="st">"`cpipath'"</span> dirs <span class="st">"*CPI_*_M"</span></span>
<span id="cb15-3"><a href="prepare.html#cb15-3"></a></span>
<span id="cb15-4"><a href="prepare.html#cb15-4"></a><span class="kw">local</span> cpivins <span class="st">"0"</span></span>
<span id="cb15-5"><a href="prepare.html#cb15-5"></a><span class="kw">foreach</span> cpidir <span class="kw">of</span> <span class="kw">local</span> cpidirs {</span>
<span id="cb15-6"><a href="prepare.html#cb15-6"></a>    <span class="kw">if</span> <span class="fu">regexm</span>(<span class="st">"`cpidir'"</span>, <span class="st">"cpi_v([0-9]+)_m"</span>) <span class="kw">local</span> cpivin = <span class="fu">regexs</span>(1)</span>
<span id="cb15-7"><a href="prepare.html#cb15-7"></a>    <span class="kw">local</span> cpivins <span class="st">"`cpivins', `cpivin'"</span></span>
<span id="cb15-8"><a href="prepare.html#cb15-8"></a>}</span>
<span id="cb15-9"><a href="prepare.html#cb15-9"></a><span class="kw">local</span> cpivin = <span class="fu">max</span>(<span class="ot">`cpivins'</span>)</span>
<span id="cb15-10"><a href="prepare.html#cb15-10"></a></span>
<span id="cb15-11"><a href="prepare.html#cb15-11"></a></span>
<span id="cb15-12"><a href="prepare.html#cb15-12"></a>cap datalibweb, country(Support) <span class="fu">year</span>(2005) <span class="dv">type</span>(GMDRAW) <span class="co">/*</span></span>
<span id="cb15-13"><a href="prepare.html#cb15-13"></a><span class="co">*/</span>  surveyid(Support_2005_CPI_v0<span class="ot">`cpivin'</span>_M) <span class="co">/* </span></span>
<span id="cb15-14"><a href="prepare.html#cb15-14"></a><span class="co">*/</span>  filename(Final_CPI_PPP_to_be_used.dta)  </span></code></pre></div>
<div id="cpicaution" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Word of Caution<a class="anchor" aria-label="anchor" href="#cpicaution"><i class="fas fa-link"></i></a>
</h3>
<p>Be aware that as of today (2020-11-17) the <code>datalibweb</code> system is being updating
and it is likely that the convention used to vintage control the CPI data will
change in the following month. That is, Dec 2020. If that is the case, the code
above would be obsolete and it will need to be updated in the
<a href="https://github.com/PovcalNet-Team/pcn/blob/master/pcn_update_cpi.ado">pcn_update_cpi.ado</a>
file and in the
<a href="https://github.com/PovcalNet-Team/pcn/blob/master/pcn_master_update.ado">pcn_master_update.ado</a>.</p>
</div>
<div id="different-cpi-datasets" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> Different CPI datasets<a class="anchor" aria-label="anchor" href="#different-cpi-datasets"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>pcn</code> command updates and loads <em>two</em> databases of the CPI and PPP, and
thus, you need to update both datasets when the CPI or PPP data is updated in
DLW.</p>
<div id="special-cpi-cases" class="section level4 unnumbered" number="">
<h4>Special CPI cases<a class="anchor" aria-label="anchor" href="#special-cpi-cases"><i class="fas fa-link"></i></a>
</h4>
<p>The primary source of CPI data for PovcalNet updates is the IMF’s International
Financial Statistics (IFS) database <span class="citation">(Lakner et al. <a href="references.html#ref-laknerConsumerPriceIndices2018a" role="doc-biblioref">2018</a>)</span>. When CPI
series from surveys are deemed more appropriate, they are used instead of IFS
CPI series. Currently, six countries are in this category of ‘special CPI
cases’, including Bangladesh, Ghana, Lao, Malawi, Tajikistan, and Zimbabwe.</p>
<p>The datafiles and dofiles for the special CPI cases are stored in this path,
<code>p:/01.PovcalNet/03.QA/09.CPI/Special CPI Cases/</code>.</p>
<p>You should follow the steps below to update the special CPI cases:</p>
<ol style="list-style-type: decimal">
<li><p>Get CPI input file labeled as “Imputed_CPI_input.xlsx” from the P-drive.
This file contains raw CPI series imputed from survey to survey.</p></li>
<li><p>Update the CPI input file if necessary. This file is updated when there is a
new survey from which a new CPI can be imputed. (A country is not always a
special case: A new survey may use the IFS CPI; the imputed CPIs are only
used in exceptional cases.) The new CPIs are provided by poverty economists
(PE’s). <a href="mailto:dmahler@worldbank.org">Daniel Gerszon Mahler</a> currently
liaises with PE’s to get the correct CPI and survey year. You may contact
him for guidance and ideas for the whole exercise.</p></li>
<li><p>Get yearly annual CPI series from Datalibweb. The yearly annual series are
collated and organized by <a href="mailto:mnguyen3@worldbank.org">Minh Cong Nguyen</a>
from monthly (or, in a few cases, quarterly) IFS data and annual World
Economic Outlook (WEO) data. Use the code below to obtain the required data.</p></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb16-1"><a href="prepare.html#cb16-1"></a></span>
<span id="cb16-2"><a href="prepare.html#cb16-2"></a>dlw, country(support) <span class="fu">year</span>(2005) <span class="dv">type</span>(gmdraw) surveyid(Support_2005_CPI_v05_M) filename(Yearly_CPI_Final.dta)</span></code></pre></div>
<p>[Note that this code is for the current version of Datalibweb (i.e.,
Support_2005_CPI_v05). Check with <a href="mailto:mnguyen3@worldbank.org">Minh Cong
Nguyen</a> for the latest version and line of code
to use.]</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Generate a final data set with label “ImputedCPIs_output_yyyymmdd.dta”.
This file contains the final CPI series with the ICP reference year as base
year, which is currently 2011. See the latest file for the required format.</p></li>
<li><p>As robustness checks, construct the final CPI series afresh as in
sheet(Calculations) in “Compare Imputed CPIs yyyymmdd.xlsx” and compare the
Excel results with the Stata output. You may compare the results using the
dofile labelled “combine_countries_compare_results.do”.</p></li>
<li><p>Send the Stata output to <a href="mailto:mnguyen3@worldbank.org">Minh Cong Nguyen</a>.
He will integrate the file into his price framework.</p></li>
<li><p>Save all datafiles and dofiles in a sub-folder in the P-drive [e.g.,
P:\CPI\Special CPI Cases\PovcalNet Update Mar 2021].</p></li>
</ol>
</div>
<div id="internal-data" class="section level4 unnumbered" number="">
<h4>Internal data<a class="anchor" aria-label="anchor" href="#internal-data"><i class="fas fa-link"></i></a>
</h4>
<p>This dataset is used only by the <em>PovcalNet</em> team and can be loaded in Stata by
using the <code>pcn load cpi, clear</code> directive and updated by using the directive
<code>pcn update cpi</code>. This dataset is intended to be used for general purposes that
require deflation such as reports, papers, or even internal tests. However, it
can’t be used to update the <em>CPI</em> sheet in the master file. Though the data is
the same, the format and labels are very different between the two. If you need
to update the format of this dataset, you need to modify the file
<a href="https://github.com/PovcalNet-Team/pcn/blob/master/pcn_update_cpi.ado">pcn_update_cpi.ado</a></p>
</div>
<div id="cpi-sheet-in-the-master-file" class="section level4 unnumbered" number="">
<h4>
<em>CPI</em> sheet in the Master file<a class="anchor" aria-label="anchor" href="#cpi-sheet-in-the-master-file"><i class="fas fa-link"></i></a>
</h4>
<p>This dataset can be loaded though the directive, <code>pcn master, load(cpi)</code>. By
default the data will be loaded in Stata in wide form, which is the original
format in the master file. You can load it in Stata basically for testing and
checking purposes but it is highly discouraged to use this data for any data
work. It comes in a very unfriendly format that is only useful for the PovcalNet
system. <code>pcn</code>, however, provides the option <code>pcn master, load(cpi) shape(long)</code>
that attempts to reshape the data in long format for ease of use, but it is
still not as nice and friendly as the data loaded from <code>pcn load cpi</code>.</p>
<p>In order to updated the <em>CPI</em> sheet in the master file, you must use the
directives <code>pcn master, update(cpi)</code> and <code>pcn master, update(ppp)</code>. Even though
the CPI and PPP come from the same file, they are split in two different sheets
in the master file. Keep in mind that if the CPI vintage control in DLW changes
as mention <a href="prepare.html#cpicaution">above</a>, you will need to update the corresponding lines
in
<a href="https://github.com/PovcalNet-Team/pcn/blob/790a1b1fc721199dfe1cdbbc103d399174785cc9/pcn_master_update.ado#L71-L164">pcn_master_update.ado</a>.</p>

</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="intro-povcal.html"><span class="header-section-number">5</span> Introduction to PovcalNet Update</a></div>
<div class="next"><a href="lis-data.html"><span class="header-section-number">7</span> LIS Data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#prepare"><span class="header-section-number">6</span> Prepare data for PovcalNet update</a></li>
<li>
<a class="nav-link" href="#population"><span class="header-section-number">6.1</span> Population</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#raw-data"><span class="header-section-number">6.1.1</span> Raw data</a></li>
<li><a class="nav-link" href="#update-master-file"><span class="header-section-number">6.1.2</span> update master file</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#gdp-and-consumption-pce"><span class="header-section-number">6.2</span> GDP and Consumption (PCE)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#raw-data-1"><span class="header-section-number">6.2.1</span> Raw data</a></li>
<li><a class="nav-link" href="#update-master-file-1"><span class="header-section-number">6.2.2</span> Update master file</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#cpi-and-ppp"><span class="header-section-number">6.3</span> CPI and PPP</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cpicaution"><span class="header-section-number">6.3.1</span> Word of Caution</a></li>
<li><a class="nav-link" href="#different-cpi-datasets"><span class="header-section-number">6.3.2</span> Different CPI datasets</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines//blob/master/prepare_data_for_update.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PovcalNet-Team/Povcalnet_internal_guidelines//edit/master/prepare_data_for_update.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>PovcalNet Internal Guidelines and Protocols</strong>" was written by PovcalNet team, Development Data Group, World Bank Group. It was last built on 2021-01-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
